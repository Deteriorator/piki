<!DOCTYPE html><html lang="en"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="Wancheng' blog"><title>修改pip下载源，快速安装python包 | ForgetWall</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/6.0.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.2/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.2/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">修改pip下载源，快速安装python包</h1><a id="logo" href="/.">ForgetWall</a><p class="description">Write it down and forget all.</p></div><div id="nav-menu"><a href="/." class="current"><i class="fa fa-home"> Home</i></a><a href="/archives/"><i class="fa fa-archive"> Archive</i></a><a href="/about/"><i class="fa fa-user"> About</i></a><a href="/atom.xml"><i class="fa fa-rss"> RSS</i></a></div></div><div id="layout" class="pure-g"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">修改pip下载源，快速安装python包</h1><div class="post-meta">Apr 20, 2017<span> | </span><span class="category"><a href="/categories/学习/">学习</a></span><script src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> Hits</span></span></div><div class="post-content"><p>今天升级pip的时候，遇到如下错误：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div></pre></td><td class="code"><pre><div class="line">$ sudo pip3 install --upgrade pip3</div><div class="line">The directory &apos;/home/wancheng/.cache/pip/http&apos; or its parent directory is not owned by the current user and the cache has been disabled. Please check the permissions and owner of that directory. If executing pip with sudo, you may want sudo&apos;s -H flag.</div><div class="line">The directory &apos;/home/wancheng/.cache/pip&apos; or its parent directory is not owned by the current user and caching wheels has been disabled. check the permissions and owner of that directory. If executing pip with sudo, you may want sudo&apos;s -H flag.</div><div class="line">Collecting pip3</div><div class="line">Exception:</div><div class="line">Traceback (most recent call last):</div><div class="line">  File &quot;/usr/share/python-wheels/urllib3-1.13.1-py2.py3-none-any.whl/urllib3/connection.py&quot;, line 137, in _new_conn</div><div class="line">    (self.host, self.port), self.timeout, **extra_kw)</div><div class="line">  File &quot;/usr/share/python-wheels/urllib3-1.13.1-py2.py3-none-any.whl/urllib3/util/connection.py&quot;, line 91, in create_connection</div><div class="line">    raise err</div><div class="line">  File &quot;/usr/share/python-wheels/urllib3-1.13.1-py2.py3-none-any.whl/urllib3/util/connection.py&quot;, line 81, in create_connection</div><div class="line">    sock.connect(sa)</div><div class="line">OSError: [Errno 101] Network is unreachable</div><div class="line"></div><div class="line">During handling of the above exception, another exception occurred:</div><div class="line"></div><div class="line">Traceback (most recent call last):</div><div class="line">  File &quot;/usr/share/python-wheels/urllib3-1.13.1-py2.py3-none-any.whl/urllib3/connectionpool.py&quot;, line 560, in urlopen</div><div class="line">    body=body, headers=headers)</div><div class="line">  File &quot;/usr/share/python-wheels/urllib3-1.13.1-py2.py3-none-any.whl/urllib3/connectionpool.py&quot;, line 346, in _make_request</div><div class="line">    self._validate_conn(conn)</div><div class="line">  File &quot;/usr/share/python-wheels/urllib3-1.13.1-py2.py3-none-any.whl/urllib3/connectionpool.py&quot;, line 787, in _validate_conn</div><div class="line">    conn.connect()</div><div class="line">  File &quot;/usr/share/python-wheels/urllib3-1.13.1-py2.py3-none-any.whl/urllib3/connection.py&quot;, line 217, in connect</div><div class="line">    conn = self._new_conn()</div><div class="line">  File &quot;/usr/share/python-wheels/urllib3-1.13.1-py2.py3-none-any.whl/urllib3/connection.py&quot;, line 146, in _new_conn</div><div class="line">    self, &quot;Failed to establish a new connection: %s&quot; % e)</div><div class="line">requests.packages.urllib3.exceptions.NewConnectionError: &lt;requests.packages.urllib3.connection.VerifiedHTTPSConnection object at 0x7fc5206ce630&gt;: Failed to establish a new connection: [Errno 101] Network is unreachable</div><div class="line"></div><div class="line">During handling of the above exception, another exception occurred:</div><div class="line"></div><div class="line">Traceback (most recent call last):</div><div class="line">  File &quot;/usr/lib/python3/dist-packages/pip/basecommand.py&quot;, line 209, in main</div><div class="line">    status = self.run(options, args)</div><div class="line">  File &quot;/usr/lib/python3/dist-packages/pip/commands/install.py&quot;, line 317, in run</div><div class="line">    requirement_set.prepare_files(finder)</div><div class="line">  File &quot;/usr/lib/python3/dist-packages/pip/req/req_set.py&quot;, line 360, in prepare_files</div><div class="line">    ignore_dependencies=self.ignore_dependencies))</div><div class="line">  File &quot;/usr/lib/python3/dist-packages/pip/req/req_set.py&quot;, line 512, in _prepare_file</div><div class="line">    finder, self.upgrade, require_hashes)</div><div class="line">  File &quot;/usr/lib/python3/dist-packages/pip/req/req_install.py&quot;, line 273, in populate_link</div><div class="line">    self.link = finder.find_requirement(self, upgrade)</div><div class="line">  File &quot;/usr/lib/python3/dist-packages/pip/index.py&quot;, line 442, in find_requirement</div><div class="line">    all_candidates = self.find_all_candidates(req.name)</div><div class="line">  File &quot;/usr/lib/python3/dist-packages/pip/index.py&quot;, line 400, in find_all_candidates</div><div class="line">    for page in self._get_pages(url_locations, project_name):</div><div class="line">  File &quot;/usr/lib/python3/dist-packages/pip/index.py&quot;, line 545, in _get_pages</div><div class="line">    page = self._get_page(location)</div><div class="line">  File &quot;/usr/lib/python3/dist-packages/pip/index.py&quot;, line 648, in _get_page</div><div class="line">    return HTMLPage.get_page(link, session=self.session)</div><div class="line">  File &quot;/usr/lib/python3/dist-packages/pip/index.py&quot;, line 757, in get_page</div><div class="line">    &quot;Cache-Control&quot;: &quot;max-age=600&quot;,</div><div class="line">  File &quot;/usr/share/python-wheels/requests-2.9.1-py2.py3-none-any.whl/requests/sessions.py&quot;, line 480, in get</div><div class="line">    return self.request(&apos;GET&apos;, url, **kwargs)</div><div class="line">  File &quot;/usr/lib/python3/dist-packages/pip/download.py&quot;, line 378, in request</div><div class="line">    return super(PipSession, self).request(method, url, *args, **kwargs)</div><div class="line">  File &quot;/usr/share/python-wheels/requests-2.9.1-py2.py3-none-any.whl/requests/sessions.py&quot;, line 468, in request</div><div class="line">    resp = self.send(prep, **send_kwargs)</div><div class="line">  File &quot;/usr/share/python-wheels/requests-2.9.1-py2.py3-none-any.whl/requests/sessions.py&quot;, line 576, in send</div><div class="line">    r = adapter.send(request, **kwargs)</div><div class="line">  File &quot;/usr/share/python-wheels/CacheControl-0.11.5-py2.py3-none-any.whl/cachecontrol/adapter.py&quot;, line 46, in send</div><div class="line">    resp = super(CacheControlAdapter, self).send(request, **kw)</div><div class="line">  File &quot;/usr/share/python-wheels/requests-2.9.1-py2.py3-none-any.whl/requests/adapters.py&quot;, line 376, in send</div><div class="line">    timeout=timeout</div><div class="line">  File &quot;/usr/share/python-wheels/urllib3-1.13.1-py2.py3-none-any.whl/urllib3/connectionpool.py&quot;, line 610, in urlopen</div><div class="line">    _stacktrace=sys.exc_info()[2])</div><div class="line">  File &quot;/usr/share/python-wheels/urllib3-1.13.1-py2.py3-none-any.whl/urllib3/util/retry.py&quot;, line 228, in increment</div><div class="line">    total -= 1</div><div class="line">TypeError: unsupported operand type(s) for -=: &apos;Retry&apos; and &apos;int&apos;</div></pre></td></tr></table></figure>
<p>看来是连不上pypi的下载源了，好在国内也有镜像。</p>
<ul>
<li>豆瓣：<a href="http://pypi.douban.com/simple" target="_blank" rel="external">http://pypi.douban.com/simple</a></li>
</ul>
<p>如果经常切换国内网络环境，只是临时使用国内源，可以在pip命令添加参数<strong>-i</strong>，如：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo pip install tornado -i https://pypi.douban.com/simple --trusted-host pypi.douban.com</div></pre></td></tr></table></figure>
<p>也可以永久指定，需要在pip配置文件(linux:~/.pip/pip.conf)中添加如下代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">[global]</div><div class="line">index-url = https://pypi.tuna.tsinghua.edu.cn/simple</div><div class="line">trusted-host:pypi.douban.com</div></pre></td></tr></table></figure></div><script type="text/javascript" src="/js/share.js?v=0.0.0" async></script><a data-url="http://wancheng.site/2017/04/20/pip_source/" data-id="cj3fofpu00019rpulzssjaih3" class="article-share-link">Share</a><div class="tags"><a href="/tags/Python/">Python</a></div><div class="post-nav"><a href="/2017/04/19/git_tips/" class="pre">Git常用操作</a><a href="/2017/04/20/tornado自动扫描注入handlers/" class="next">tornado自动扫描注入handlers</a></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><form action="//www.baidu.com/baidu" method="get" accept-charset="utf-8" target="_blank" class="search-form"><input type="search" name="word" maxlength="20" placeholder="Search"/><input type="hidden" name="si" value="http://wancheng.site"/><input name="tn" type="hidden" value="bds"/><input name="cl" type="hidden" value="3"/><input name="ct" type="hidden" value="2097152"/><input name="s" type="hidden" value="on"/></form></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> Categories</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Programming/">Programming</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/学习/">学习</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/工作/">工作</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/测试/">测试</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/编程工具/">编程工具</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> Tags</i></div><div class="tagcloud"><a href="/tags/Tmux/" style="font-size: 15px;">Tmux</a> <a href="/tags/帐号/" style="font-size: 15px;">帐号</a> <a href="/tags/神经网络/" style="font-size: 15px;">神经网络</a> <a href="/tags/Linux/" style="font-size: 15px;">Linux</a> <a href="/tags/Python/" style="font-size: 15px;">Python</a> <a href="/tags/单元测试-tornado/" style="font-size: 15px;">单元测试,tornado</a> <a href="/tags/Tornado/" style="font-size: 15px;">Tornado</a> <a href="/tags/vim/" style="font-size: 15px;">vim</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> Recent</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2017/06/02/How-to-build-a-simple-neural-network-in-9-lines-of-Python-code/">如何用九行Python代码构建一个神经网络</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/05/27/weekreport20170527/">周报20170527</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/05/27/weekreport20170602/">周报20170527</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/05/19/weekreport20170519/">周报20170519</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/05/16/sshmanager/">sshmanager</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/05/16/torndb_max_idle/">torndb_max_idle</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/05/15/tornado_unittesting/">Tornado单元测试</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/05/05/weekreport20170505/">周报20170505</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/05/05/weekreport20170512/">周报20170505</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/04/30/python-packages-for-crawler/">python_packages_for_crawler</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> Links</i></div><ul></ul><a href="http://coolshell.cn/" title="酷壳 - COOLSHELL" target="_blank">酷壳 - COOLSHELL</a><ul></ul><a href="http://www.moseeker.com/" title="MoSeeker" target="_blank">MoSeeker</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">© <a>2017 </a><a href="/." rel="nofollow">ForgetWall.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a id="rocket" href="#top" class="show"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/3.0.47/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/fancybox/3.0.47/jquery.fancybox.min.css"><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>